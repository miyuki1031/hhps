/**

url を書かない のが Prisma 7
Error: Prisma schema validation - (get-config wasm)
Error code: P1012
error: The datasource property `url` is no longer supported in schema files. Move connection URLs for Migrate to `prisma.config.ts` and pass either `adapter` for a direct database connection or `accelerateUrl` for Accelerate to the `PrismaClient` constructor. See https://pris.ly/d/config-datasource and https://pris.ly/d/prisma7-client-config

そのため「prisma.config.ts」で記載する

*/
datasource db {
  provider = "postgresql"
  url      = env("POSTGRES_PRISMA_URL")// url      = "file:./dev.db"  // ここにURLを戻します
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id              String  @id @default(cuid())
  name            String  @db.VarChar(100) // DB側で @db.VarChar(100) と書けば文字数制限も可能
  email           String  @unique // ログインに必須
  passwordHash    String  // パスワード（ハッシュ化して保存）
  authority       String  @default("Guest") // "Master" "Guest"
  // 2要素認証用
  twoFactorSecret String? // Masterのみ使用（最初はnull許容）

  isValid          Boolean @default(true)//  論理
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt
  todos Todo[]            // 追加
}

model Todo {
  id           String @id @default(cuid())
  userId       String
  title        String
  completed    Boolean  @default(false)
  
  // 新しい項目
  category     String   // work: 仕事, private: プライベート　other：
  priority     Int      // 0: 低, 1: 中, 2: 高
  explanation  String?  // 説明（空でもOKなら ? をつける）
  targetDate   DateTime? // 目標日
  progressRate Int      @default(0) // 進捗率 (0〜100)
  isValid      Boolean  @default(true)
  user   User  @relation(fields: [userId], references: [id])

  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt // 更新日時もあると便利です
}

